<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è©³ç´°ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†æãƒ„ãƒ¼ãƒ« - Firewall/SQLæ¤œå‡º</title>
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --info: #8b5cf6;
            --dark-bg: #0f172a;
            --dark-panel: #1e293b;
            --dark-border: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1e293b 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: var(--dark-panel);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            overflow: hidden;
            border: 1px solid var(--dark-border);
        }
        
        .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 35px 40px;
            border-bottom: 1px solid var(--dark-border);
            position: relative;
            overflow: hidden;
        }
        
        .header:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--success), var(--info), var(--warning));
        }
        
        .header h1 {
            font-size: 2.6rem;
            margin-bottom: 15px;
            font-weight: 800;
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 50%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .header h1:before {
            content: "ğŸ›¡ï¸";
            font-size: 2.8rem;
            -webkit-text-fill-color: initial;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.15rem;
            max-width: 1000px;
            color: var(--text-secondary);
        }
        
        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 25px;
            padding: 30px;
            min-height: 800px;
        }
        
        /* å·¦ã‚«ãƒ©ãƒ  */
        .left-column {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        /* ãƒ‘ãƒãƒ«å…±é€š */
        .panel {
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid var(--dark-border);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--dark-border);
        }
        
        .panel-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒãƒ« */
        #requestPanel .panel-title:before { content: "ğŸš€"; }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .url-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .protocol-select {
            padding: 12px 15px;
            border: 2px solid #475569;
            border-radius: 10px;
            background: #1e293b;
            color: var(--text-primary);
            font-weight: 600;
            min-width: 100px;
            cursor: pointer;
        }
        
        .url-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #475569;
            border-radius: 10px;
            background: #1e293b;
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        .method-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .method-btn {
            padding: 10px;
            border: 2px solid #475569;
            border-radius: 8px;
            background: #1e293b;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }
        
        .method-btn:hover {
            border-color: var(--primary);
        }
        
        .method-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .option-item input {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
        }
        
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }
        
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }
        
        .btn-secondary {
            background: #334155;
            color: var(--text-primary);
        }
        
        /* è©³ç´°æƒ…å ±ãƒ‘ãƒãƒ« */
        #detailsPanel .panel-title:before { content: "ğŸ“Š"; }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .info-card {
            background: rgba(51, 65, 85, 0.5);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }
        
        .info-card.warning { border-left-color: var(--warning); }
        .info-card.danger { border-left-color: var(--danger); }
        .info-card.success { border-left-color: var(--success); }
        
        .info-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Monaco', 'Courier New', monospace;
            word-break: break-all;
        }
        
        /* ä¸­å¤®ã‚«ãƒ©ãƒ  */
        .center-column {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        /* çµŒè·¯å›³ */
        #pathPanel .panel-title:before { content: "ğŸ›£ï¸"; }
        
        .path-container {
            height: 300px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 12px;
            border: 2px dashed #475569;
            padding: 20px;
            overflow-x: auto;
            overflow-y: hidden;
            position: relative;
        }
        
        .path-diagram {
            display: flex;
            align-items: center;
            min-width: max-content;
            height: 100%;
            gap: 40px;
            padding: 20px 0;
        }
        
        .hop-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            min-width: 180px;
        }
        
        .hop-number {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .hop-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 15px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        .hop-label {
            background: rgba(30, 41, 59, 0.9);
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            max-width: 160px;
            word-break: break-word;
            border: 1px solid var(--dark-border);
        }
        
        .hop-arrow {
            position: absolute;
            right: -30px;
            top: 35px;
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        /* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒãƒ« */
        #securityPanel .panel-title:before { content: "ğŸ›¡ï¸"; }
        
        .security-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .security-item {
            background: rgba(51, 65, 85, 0.5);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .security-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        /* å³ã‚«ãƒ©ãƒ  */
        .right-column {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        /* ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ãƒãƒ« */
        #databasePanel .panel-title:before { content: "ğŸ—„ï¸"; }
        
        .database-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 250px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .database-item {
            background: rgba(51, 65, 85, 0.5);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-left: 4px solid var(--info);
        }
        
        .db-icon {
            font-size: 1.8rem;
        }
        
        .db-info {
            flex: 1;
        }
        
        .db-name {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .db-details {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        /* ãƒ­ã‚°ãƒ‘ãƒãƒ« */
        #logPanel .panel-title:before { content: "ğŸ“‹"; }
        
        .log-container {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .log-entry {
            padding: 12px 15px;
            border-radius: 8px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            border-left: 4px solid;
            background: rgba(30, 41, 59, 0.7);
        }
        
        .log-entry.info { border-color: var(--primary); }
        .log-entry.success { border-color: var(--success); }
        .log-entry.warning { border-color: var(--warning); }
        .log-entry.error { border-color: var(--danger); }
        
        .log-time {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-bottom: 5px;
        }
        
        .log-message {
            color: var(--text-primary);
        }
        
        /* ãƒ•ãƒƒã‚¿ãƒ¼ */
        .footer {
            padding: 20px 40px;
            background: rgba(15, 23, 42, 0.8);
            border-top: 1px solid var(--dark-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .footer-stats {
            display: flex;
            gap: 20px;
        }
        
        /* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-active { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .status-blocked { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .status-warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        
        .spinner {
            border: 2px solid rgba(255,255,255,0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 1400px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <h1>è©³ç´°ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†æãƒ„ãƒ¼ãƒ«</h1>
            <p>IPãƒ»MACã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»Firewallãƒ»SQLæ¥ç¶šãƒ»é€šä¿¡çµŒè·¯ãªã©ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®æƒ…å ±ã‚’è©³ç´°ã«åˆ†æãƒ»å¯è¦–åŒ–ã—ã¾ã™</p>
        </div>
        
        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div class="main-content">
            <!-- å·¦ã‚«ãƒ©ãƒ  -->
            <div class="left-column">
                <!-- ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨­å®š -->
                <div class="panel" id="requestPanel">
                    <div class="panel-header">
                        <div class="panel-title">ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨­å®š</div>
                        <div class="status-badge status-active" id="connectionStatus">æ¥ç¶šå¯èƒ½</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">é€ä¿¡å…ˆURL</label>
                        <div class="url-input-group">
                            <select class="protocol-select" id="protocol">
                                <option value="https://">https://</option>
                                <option value="http://">http://</option>
                                <option value="ws://">ws://</option>
                                <option value="wss://">wss://</option>
                            </select>
                            <input type="text" class="url-input" id="url" 
                                   placeholder="example.com ã¾ãŸã¯ example.com/api/data"
                                   value="jsonplaceholder.typicode.com/posts/1">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">HTTPãƒ¡ã‚½ãƒƒãƒ‰</label>
                        <div class="method-buttons">
                            <button class="method-btn active" data-method="GET">GET</button>
                            <button class="method-btn" data-method="POST">POST</button>
                            <button class="method-btn" data-method="PUT">PUT</button>
                            <button class="method-btn" data-method="DELETE">DELETE</button>
                            <button class="method-btn" data-method="HEAD">HEAD</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">åˆ†æã‚ªãƒ—ã‚·ãƒ§ãƒ³</label>
                        <div class="options-grid">
                            <div class="option-item">
                                <input type="checkbox" id="optTrace" checked>
                                <label for="optTrace">çµŒè·¯ãƒˆãƒ¬ãƒ¼ã‚¹</label>
                            </div>
                            <div class="option-item">
                                <input type="checkbox" id="optFirewall" checked>
                                <label for="optFirewall">Firewallæ¤œå‡º</label>
                            </div>
                            <div class="option-item">
                                <input type="checkbox" id="optDatabase" checked>
                                <label for="optDatabase">DBæ¥ç¶šæ¤œå‡º</label>
                            </div>
                            <div class="option-item">
                                <input type="checkbox" id="optHeaders" checked>
                                <label for="optHeaders">è©³ç´°ãƒ˜ãƒƒãƒ€ãƒ¼</label>
                            </div>
                            <div class="option-item">
                                <input type="checkbox" id="optSecurity" checked>
                                <label for="optSecurity">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ</label>
                            </div>
                            <div class="option-item">
                                <input type="checkbox" id="optPerformance" checked>
                                <label for="optPerformance">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-primary" id="sendBtn">
                            <span id="btnText">ğŸ” åˆ†æé–‹å§‹</span>
                            <span class="spinner" id="btnSpinner" style="display: none;"></span>
                        </button>
                        <button class="btn btn-secondary" id="clearBtn">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
                    </div>
                </div>
                
                <!-- è©³ç´°æƒ…å ± -->
                <div class="panel" id="detailsPanel">
                    <div class="panel-header">
                        <div class="panel-title">è©³ç´°æƒ…å ±</div>
                    </div>
                    <div class="info-grid">
                        <div class="info-card">
                            <div class="info-label">ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIP</div>
                            <div class="info-value" id="clientIP">å–å¾—ä¸­...</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</div>
                            <div class="info-value" id="userAgent">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">ãƒ–ãƒ©ã‚¦ã‚¶</div>
                            <div class="info-value" id="browserInfo">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                            <div class="info-value" id="platform">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">è¨€èª</div>
                            <div class="info-value" id="language">-</div>
                        </div>
                        <div class="info-card">
                            <div class="info-label">ç”»é¢è§£åƒåº¦</div>
                            <div class="info-value" id="resolution">-</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ä¸­å¤®ã‚«ãƒ©ãƒ  -->
            <div class="center-column">
                <!-- é€šä¿¡çµŒè·¯ -->
                <div class="panel" id="pathPanel">
                    <div class="panel-header">
                        <div class="panel-title">é€šä¿¡çµŒè·¯å›³</div>
                        <div class="status-badge" id="pathStatus">æº–å‚™å®Œäº†</div>
                    </div>
                    <div class="path-container">
                        <div class="path-diagram" id="pathDiagram">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ -->
                <div class="panel" id="securityPanel">
                    <div class="panel-header">
                        <div class="panel-title">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ</div>
                        <div class="status-badge status-active" id="securityStatus">ã‚»ã‚­ãƒ¥ã‚¢</div>
                    </div>
                    <div class="security-grid">
                        <div class="security-item">
                            <div class="security-icon">ğŸ›¡ï¸</div>
                            <div class="info-label">Firewallæ¤œå‡º</div>
                            <div class="info-value" id="firewallCount">0ä»¶</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">ğŸ”’</div>
                            <div class="info-label">SSLè¨¼æ˜æ›¸</div>
                            <div class="info-value" id="sslStatus">æœªç¢ºèª</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">ğŸš«</div>
                            <div class="info-label">ãƒ–ãƒ­ãƒƒã‚¯ç®‡æ‰€</div>
                            <div class="info-value" id="blockCount">0ç®‡æ‰€</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">ğŸŒ</div>
                            <div class="info-label">CDNæ¤œå‡º</div>
                            <div class="info-value" id="cdnCount">0ä»¶</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">â±ï¸</div>
                            <div class="info-label">å¿œç­”æ™‚é–“</div>
                            <div class="info-value" id="responseTime">-</div>
                        </div>
                        <div class="security-item">
                            <div class="security-icon">ğŸ“Š</div>
                            <div class="info-label">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
                            <div class="info-value" id="httpStatus">-</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å³ã‚«ãƒ©ãƒ  -->
            <div class="right-column">
                <!-- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š -->
                <div class="panel" id="databasePanel">
                    <div class="panel-header">
                        <div class="panel-title">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ¤œå‡º</div>
                        <div class="status-badge" id="dbStatus">æœªæ¤œå‡º</div>
                    </div>
                    <div class="database-list" id="databaseList">
                        <div class="database-item">
                            <div class="db-icon">ğŸ—„ï¸</div>
                            <div class="db-info">
                                <div class="db-name">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š</div>
                                <div class="db-details">ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡å¾Œã«æ¤œå‡ºã•ã‚Œã¾ã™</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ãƒ­ã‚° -->
                <div class="panel" id="logPanel">
                    <div class="panel-header">
                        <div class="panel-title">è©³ç´°ãƒ­ã‚°</div>
                        <button class="btn-secondary" id="exportLogs" style="padding: 5px 10px; font-size: 0.8rem;">ğŸ“¥ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                    </div>
                    <div class="log-container" id="logContainer">
                        <div class="log-entry info">
                            <div class="log-time">ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•</div>
                            <div class="log-message">è©³ç´°ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†æãƒ„ãƒ¼ãƒ«ãŒèµ·å‹•ã—ã¾ã—ãŸ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
        <div class="footer">
            <div>
                <strong>è©³ç´°ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ†æãƒ„ãƒ¼ãƒ« v1.0</strong> | å˜ä¸€HTMLãƒ•ã‚¡ã‚¤ãƒ«ã§å®Œå…¨å‹•ä½œ
            </div>
            <div class="footer-stats">
                <span>é€šä¿¡æ•°: <span id="totalRequests">0</span></span>
                <span>æ¤œå‡ºã‚µãƒ¼ãƒãƒ¼: <span id="totalServers">0</span></span>
                <span>å®Ÿè¡Œæ™‚é–“: <span id="uptime">0s</span></span>
            </div>
        </div>
    </div>

    <script>
        // ============== ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ==============
        class RequestAnalyzer {
            constructor() {
                this.logs = [];
                this.totalRequests = 0;
                this.detectedServers = new Set();
                this.startTime = Date.now();
                this.isAnalyzing = false;
                
                this.init();
                this.setupEventListeners();
                this.loadClientInfo();
                this.startUptimeCounter();
                this.addLog("ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†", "info");
            }
            
            init() {
                // ãƒ¡ã‚½ãƒƒãƒ‰ãƒœã‚¿ãƒ³ã®è¨­å®š
                document.querySelectorAll('.method-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.method-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                    });
                });
                
                // åˆæœŸçµŒè·¯å›³ã®è¡¨ç¤º
                this.updatePathDiagram([]);
            }
            
            setupEventListeners() {
                document.getElementById('sendBtn').addEventListener('click', () => this.startAnalysis());
                document.getElementById('clearBtn').addEventListener('click', () => this.clearAnalysis());
                document.getElementById('exportLogs').addEventListener('click', () => this.exportLogs());
            }
            
            loadClientInfo() {
                // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæƒ…å ±ã®å–å¾—
                document.getElementById('userAgent').textContent = navigator.userAgent;
                document.getElementById('browserInfo').textContent = this.detectBrowser();
                document.getElementById('platform').textContent = navigator.platform;
                document.getElementById('language').textContent = navigator.language;
                document.getElementById('resolution').textContent = `${window.screen.width} Ã— ${window.screen.height}`;
                
                // ç–‘ä¼¼IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆå®Ÿéš›ã®IPã¯ã‚µãƒ¼ãƒãƒ¼å´ã§ã—ã‹å–å¾—ä¸å¯ï¼‰
                const pseudoIP = this.generatePseudoIP();
                document.getElementById('clientIP').textContent = pseudoIP;
                
                this.addLog(`ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ã—ã¾ã—ãŸ (IP: ${pseudoIP})`, "info");
            }
            
            async startAnalysis() {
                if (this.isAnalyzing) return;
                
                this.isAnalyzing = true;
                const urlInput = document.getElementById('url').value.trim();
                const protocol = document.getElementById('protocol').value;
                const method = document.querySelector('.method-btn.active').dataset.method;
                const fullUrl = protocol + urlInput;
                
                if (!urlInput) {
                    this.addLog("URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„", "error");
                    return;
                }
                
                // UIçŠ¶æ…‹ã®æ›´æ–°
                this.updateButtonState(true);
                this.addLog(`ãƒªã‚¯ã‚¨ã‚¹ãƒˆé–‹å§‹: ${method} ${fullUrl}`, "info");
                
                try {
                    // çµŒè·¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                    const path = await this.simulateTraceroute(fullUrl);
                    
                    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡
                    const response = await this.sendRequest(method, fullUrl);
                    
                    // è©³ç´°åˆ†æ
                    await this.analyzeResponse(response, fullUrl, path);
                    
                    this.totalRequests++;
                    this.updateStats();
                    
                } catch (error) {
                    this.addLog(`ã‚¨ãƒ©ãƒ¼: ${error.message}`, "error");
                    this.updateSecurityStatus("error");
                } finally {
                    this.isAnalyzing = false;
                    this.updateButtonState(false);
                }
            }
            
            async sendRequest(method, url) {
                const startTime = performance.now();
                
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000);
                    
                    const response = await fetch(url, {
                        method: method,
                        signal: controller.signal,
                        headers: {
                            'User-Agent': 'RequestAnalyzer/1.0',
                            'Accept': 'application/json,text/html',
                            'X-Analyzer': 'true'
                        }
                    });
                    
                    clearTimeout(timeoutId);
                    
                    const endTime = performance.now();
                    const responseTime = Math.round(endTime - startTime);
                    
                    this.addLog(`å¿œç­”å—ä¿¡: ${response.status} (${responseTime}ms)`, "success");
                    document.getElementById('responseTime').textContent = `${responseTime}ms`;
                    document.getElementById('httpStatus').textContent = response.status;
                    
                    return response;
                    
                } catch (error) {
                    throw new Error(`ãƒªã‚¯ã‚¨ã‚¹ãƒˆå¤±æ•—: ${error.message}`);
                }
            }
            
            async simulateTraceroute(url) {
                this.addLog("çµŒè·¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’é–‹å§‹...", "info");
                
                // ç–‘ä¼¼çµŒè·¯ç”Ÿæˆï¼ˆå®Ÿéš›ã®tracerouteã¯ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ä¸å¯ï¼‰
                const hops = [
                    { hop: 1, type: "router", name: "ãƒ­ãƒ¼ã‚«ãƒ«ãƒ«ãƒ¼ã‚¿ãƒ¼", ip: "192.168.1.1", responseTime: 2 },
                    { hop: 2, type: "isp", name: "ISPã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤", ip: "203.0.113.1", responseTime: 15 },
                    { hop: 3, type: "firewall", name: "å¢ƒç•Œãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«", ip: "203.0.113.10", responseTime: 8 },
                    { hop: 4, type: "loadbalancer", name: "ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼", ip: "198.51.100.1", responseTime: 25 },
                    { hop: 5, type: "server", name: "Webã‚µãƒ¼ãƒãƒ¼", ip: "198.51.100.10", responseTime: 40 },
                    { hop: 6, type: "database", name: "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼", ip: "10.0.0.10", responseTime: 60 }
                ];
                
                // ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ–ãƒ­ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã®è¿½åŠ 
                if (Math.random() > 0.7) {
                    hops[2].blocked = true;
                    hops[2].blockReason = "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼é•å";
                }
                
                // DNSã‚µãƒ¼ãƒãƒ¼ã®è¿½åŠ 
                if (Math.random() > 0.5) {
                    hops.splice(3, 0, { 
                        hop: 3, 
                        type: "dns", 
                        name: "DNSã‚µãƒ¼ãƒãƒ¼", 
                        ip: "8.8.8.8", 
                        responseTime: 12 
                    });
                    // ãƒ›ãƒƒãƒ—ç•ªå·ã‚’æ›´æ–°
                    hops.forEach((hop, index) => hop.hop = index + 1);
                }
                
                // çµŒè·¯å›³ã®æ›´æ–°
                this.updatePathDiagram(hops);
                
                // çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
                document.getElementById('hopCount').textContent = hops.length;
                this.detectedServers.add(url);
                
                return hops;
            }
            
            async analyzeResponse(response, url, path) {
                this.addLog("è©³ç´°åˆ†æã‚’é–‹å§‹...", "info");
                
                // ãƒ˜ãƒƒãƒ€ãƒ¼åˆ†æ
                await this.analyzeHeaders(response.headers);
                
                // Firewallæ¤œå‡º
                await this.detectFirewall(response, path);
                
                // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ¤œå‡º
                await this.detectDatabaseConnections(url, response);
                
                // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ
                await this.analyzeSecurity(response, url);
                
                // ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã®åˆ†æ
                await this.analyzeResponseContent(response);
            }
            
            async analyzeHeaders(headers) {
                const headerInfo = [];
                headers.forEach((value, key) => {
                    headerInfo.push(`${key}: ${value}`);
                });
                
                this.addLog(`æ¤œå‡ºãƒ˜ãƒƒãƒ€ãƒ¼: ${headerInfo.length}ä»¶`, "info");
                
                // ç‰¹å®šã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒã‚§ãƒƒã‚¯
                const securityHeaders = {
                    'X-Frame-Options': 'ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°å¯¾ç­–',
                    'Content-Security-Policy': 'CSPãƒãƒªã‚·ãƒ¼',
                    'Strict-Transport-Security': 'HSTSè¨­å®š',
                    'X-Content-Type-Options': 'MIMEã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°é˜²æ­¢'
                };
                
                Object.keys(securityHeaders).forEach(header => {
                    if (headers.get(header)) {
                        this.addLog(`ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼æ¤œå‡º: ${header}`, "success");
                    }
                });
            }
            
            async detectFirewall(response, path) {
                const firewallSigns = [];
                
                // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰Firewallã®å…†å€™ã‚’æ¤œå‡º
                const headers = response.headers;
                const url = response.url;
                
                // Cloudflareæ¤œå‡º
                if (headers.get('cf-ray') || headers.get('server')?.includes('cloudflare')) {
                    firewallSigns.push({
                        type: 'waf',
                        name: 'Cloudflare WAF',
                        level: 'high',
                        evidence: 'CF-Rayãƒ˜ãƒƒãƒ€ãƒ¼'
                    });
                }
                
                // AWS WAFæ¤œå‡º
                if (headers.get('x-amz-cf-id') || url.includes('.cloudfront.net')) {
                    firewallSigns.push({
                        type: 'waf',
                        name: 'AWS WAF / CloudFront',
                        level: 'high',
                        evidence: 'AWSãƒ˜ãƒƒãƒ€ãƒ¼'
                    });
                }
                
                // ãƒ–ãƒ­ãƒƒã‚¯ç®‡æ‰€ã®æ¤œå‡º
                const blockedHops = path.filter(hop => hop.blocked);
                blockedHops.forEach(hop => {
                    firewallSigns.push({
                        type: 'block',
                        name: `ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ (Hop ${hop.hop})`,
                        level: 'danger',
                        evidence: hop.blockReason || 'ä¸æ˜'
                    });
                });
                
                // UIæ›´æ–°
                const firewallCount = firewallSigns.filter(f => f.type === 'waf').length;
                const blockCount = firewallSigns.filter(f => f.type === 'block').length;
                
                document.getElementById('firewallCount').textContent = `${firewallCount}ä»¶`;
                document.getElementById('blockCount').textContent = `${blockCount}ç®‡æ‰€`;
                
                if (firewallSigns.length > 0) {
                    this.addLog(`Firewallæ¤œå‡º: ${firewallSigns.length}ä»¶`, firewallSigns.some(f => f.type === 'block') ? "warning" : "info");
                    this.updateSecurityStatus(blockCount > 0 ? "warning" : "active");
                }
            }
            
            async detectDatabaseConnections(url, response) {
                const databases = [];
                
                // URLãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰ã®æ¤œå‡º
                const dbPatterns = [
                    { pattern: /mysql|mariadb/i, name: 'MySQL', port: 3306, icon: 'ğŸ¬' },
                    { pattern: /postgres|pgsql/i, name: 'PostgreSQL', port: 5432, icon: 'ğŸ˜' },
                    { pattern: /mongodb/i, name: 'MongoDB', port: 27017, icon: 'ğŸƒ' },
                    { pattern: /redis/i, name: 'Redis', port: 6379, icon: 'ğŸ”´' },
                    { pattern: /sqlite/i, name: 'SQLite', port: null, icon: 'ğŸ’¾' },
                    { pattern: /oracle/i, name: 'Oracle DB', port: 1521, icon: 'ğŸ—¿' },
                    { pattern: /sqlserver|mssql/i, name: 'SQL Server', port: 1433, icon: 'ğŸ’¼' }
                ];
                
                // URLã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å†…å®¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œå‡º
                dbPatterns.forEach(db => {
                    if (db.pattern.test(url) || 
                        (response.headers.get('server') && db.pattern.test(response.headers.get('server')))) {
                        databases.push({
                            ...db,
                            detectedBy: 'ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è‡´',
                            confidence: 'é«˜'
                        });
                    }
                });
                
                // ãƒ¬ã‚¹ãƒãƒ³ã‚¹æœ¬æ–‡ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡º
                try {
                    const text = await response.text();
                    const dbErrorPatterns = [
                        { pattern: /SQLSTATE|mysql_fetch|mysqli_/i, name: 'MySQL', type: 'ã‚¨ãƒ©ãƒ¼' },
                        { pattern: /PostgreSQL.*ERROR/i, name: 'PostgreSQL', type: 'ã‚¨ãƒ©ãƒ¼' },
                        { pattern: /MongoError|MongoDB/i, name: 'MongoDB', type: 'ã‚¨ãƒ©ãƒ¼' },
                        { pattern: /Redis.*error/i, name: 'Redis', type: 'ã‚¨ãƒ©ãƒ¼' },
                        { pattern: /ORA-[0-9]{5}/i, name: 'Oracle', type: 'ã‚¨ãƒ©ãƒ¼' },
                        { pattern: /Microsoft.*SQL.*Server/i, name: 'SQL Server', type: 'ã‚¨ãƒ©ãƒ¼' }
                    ];
                    
                    dbErrorPatterns.forEach(pattern => {
                        if (pattern.pattern.test(text)) {
                            const existing = databases.find(db => db.name === pattern.name);
                            if (!existing) {
                                databases.push({
                                    name: pattern.name,
                                    icon: 'âš ï¸',
                                    port: null,
                                    detectedBy: 'ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                                    confidence: 'ä¸­'
                                });
                            }
                        }
                    });
                } catch (e) {
                    // ãƒ¬ã‚¹ãƒãƒ³ã‚¹èª­ã¿å–ã‚Šå¤±æ•—
                }
                
                // UIã®æ›´æ–°
                this.updateDatabaseList(databases);
                
                if (databases.length > 0) {
                    this.addLog(`ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œå‡º: ${databases.length}ä»¶`, "success");
                    document.getElementById('dbStatus').textContent = `${databases.length}ä»¶æ¤œå‡º`;
                    document.getElementById('dbStatus').className = "status-badge status-active";
                }
            }
            
            async analyzeSecurity(response, url) {
                const securityInfo = [];
                
                // HTTPSãƒã‚§ãƒƒã‚¯
                if (url.startsWith('https://')) {
                    securityInfo.push({ type: 'ssl', status: 'æœ‰åŠ¹', level: 'success' });
                    document.getElementById('sslStatus').textContent = "æœ‰åŠ¹";
                    document.getElementById('sslStatus').style.color = "#10b981";
                } else {
                    securityInfo.push({ type: 'ssl', status: 'ç„¡åŠ¹', level: 'warning' });
                    document.getElementById('sslStatus').textContent = "ç„¡åŠ¹";
                    document.getElementById('sslStatus').style.color = "#f59e0b";
                }
                
                // CORSè¨­å®šãƒã‚§ãƒƒã‚¯
                if (response.headers.get('access-control-allow-origin')) {
                    const cors = response.headers.get('access-control-allow-origin');
                    securityInfo.push({ 
                        type: 'cors', 
                        status: cors === '*' ? 'ç·©ã„' : 'åˆ¶é™ã‚ã‚Š', 
                        level: cors === '*' ? 'warning' : 'success' 
                    });
                }
                
                // CDNæ¤œå‡º
                const cdnHeaders = ['cf-ray', 'x-amz-cf-id', 'server'];
                const detectedCDNs = cdnHeaders.filter(h => response.headers.get(h));
                document.getElementById('cdnCount').textContent = `${detectedCDNs.length}ä»¶`;
                
                if (detectedCDNs.length > 0) {
                    securityInfo.push({ type: 'cdn', status: 'æ¤œå‡º', level: 'info' });
                }
            }
            
            async analyzeResponseContent(response) {
                try {
                    const contentType = response.headers.get('content-type') || '';
                    
                    if (contentType.includes('application/json')) {
                        const data = await response.json();
                        this.addLog(`JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡ (${Object.keys(data).length}ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£)`, "info");
                    } else if (contentType.includes('text/html')) {
                        this.addLog("HTMLãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡", "info");
                    } else if (contentType.includes('text/plain')) {
                        this.addLog("ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡", "info");
                    }
                } catch (e) {
                    this.addLog("ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹ã®è§£æã«å¤±æ•—", "warning");
                }
            }
            
            updatePathDiagram(hops) {
                const diagram = document.getElementById('pathDiagram');
                diagram.innerHTML = '';
                
                // é–‹å§‹ç‚¹ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰
                const startHop = this.createHopElement({
                    hop: 0,
                    type: 'client',
                    name: 'ã‚ãªãŸã®PC',
                    ip: '192.168.1.100',
                    responseTime: 0
                });
                diagram.appendChild(startHop);
                
                // å„ãƒ›ãƒƒãƒ—ã®è¿½åŠ 
                hops.forEach(hop => {
                    const arrow = document.createElement('div');
                    arrow.className = 'hop-arrow';
                    arrow.textContent = 'â†’';
                    diagram.appendChild(arrow);
                    
                    const hopElement = this.createHopElement(hop);
                    diagram.appendChild(hopElement);
                });
                
                // ãƒ›ãƒƒãƒ—æ•°ã®è¡¨ç¤º
                document.getElementById('hopCount').textContent = hops.length;
                document.getElementById('pathStatus').textContent = hops.length > 0 ? 
                    `${hops.length}ãƒ›ãƒƒãƒ—æ¤œå‡º` : 'çµŒè·¯ãªã—';
            }
            
            createHopElement(hop) {
                const container = document.createElement('div');
                container.className = 'hop-item';
                
                if (hop.hop > 0) {
                    const number = document.createElement('div');
                    number.className = 'hop-number';
                    number.textContent = hop.hop;
                    container.appendChild(number);
                }
                
                const icon = document.createElement('div');
                icon.className = 'hop-icon';
                
                // ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸã‚¢ã‚¤ã‚³ãƒ³ã¨è‰²
                const styles = {
                    client: { emoji: 'ğŸ–¥ï¸', color: 'linear-gradient(135deg, #10b981, #059669)' },
                    router: { emoji: 'ğŸ“¡', color: 'linear-gradient(135deg, #3b82f6, #2563eb)' },
                    isp: { emoji: 'ğŸ¢', color: 'linear-gradient(135deg, #8b5cf6, #7c3aed)' },
                    firewall: { emoji: 'ğŸ›¡ï¸', color: 'linear-gradient(135deg, #ef4444, #dc2626)' },
                    loadbalancer: { emoji: 'âš–ï¸', color: 'linear-gradient(135deg, #f59e0b, #d97706)' },
                    server: { emoji: 'ğŸŒ', color: 'linear-gradient(135deg, #ec4899, #db2777)' },
                    database: { emoji: 'ğŸ—„ï¸', color: 'linear-gradient(135deg, #14b8a6, #0d9488)' },
                    dns: { emoji: 'ğŸ“š', color: 'linear-gradient(135deg, #6366f1, #4f46e5)' }
                };
                
                const style = styles[hop.type] || { emoji: 'â“', color: '#475569' };
                icon.style.background = style.color;
                icon.style.color = 'white';
                icon.textContent = style.emoji;
                
                const label = document.createElement('div');
                label.className = 'hop-label';
                label.innerHTML = `
                    <div style="font-weight: 700; margin-bottom: 3px;">${hop.name}</div>
                    <div style="font-size: 0.8rem; color: #cbd5e1;">${hop.ip || ''}</div>
                    ${hop.responseTime ? `<div style="font-size: 0.7rem; color: #94a3b8;">${hop.responseTime}ms</div>` : ''}
                    ${hop.blocked ? `<div style="color: #ef4444; font-size: 0.7rem;">ğŸš« ãƒ–ãƒ­ãƒƒã‚¯</div>` : ''}
                `;
                
                container.appendChild(icon);
                container.appendChild(label);
                return container;
            }
            
            updateDatabaseList(databases) {
                const container = document.getElementById('databaseList');
                
                if (databases.length === 0) {
                    container.innerHTML = `
                        <div class="database-item">
                            <div class="db-icon">ğŸ—„ï¸</div>
                            <div class="db-info">
                                <div class="db-name">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœªæ¤œå‡º</div>
                                <div class="db-details">ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã®ç—•è·¡ã¯ã‚ã‚Šã¾ã›ã‚“</div>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = databases.map(db => `
                    <div class="database-item">
                        <div class="db-icon">${db.icon}</div>
                        <div class="db-info">
                            <div class="db-name">${db.name}</div>
                            <div class="db-details">
                                ${db.port ? `ãƒãƒ¼ãƒˆ: ${db.port} | ` : ''}
                                æ¤œå‡ºæ–¹æ³•: ${db.detectedBy} | 
                                ä¿¡é ¼åº¦: ${db.confidence}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            addLog(message, type = "info") {
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${type}`;
                
                const time = new Date().toLocaleTimeString();
                logEntry.innerHTML = `
                    <div class="log-time">${time}</div>
                    <div class="log-message">${message}</div>
                `;
                
                const container = document.getElementById('logContainer');
                container.insertBefore(logEntry, container.firstChild);
                
                // ãƒ­ã‚°æ•°ã®åˆ¶é™
                if (container.children.length > 50) {
                    container.removeChild(container.lastChild);
                }
                
                this.logs.push({ time, message, type });
            }
            
            updateButtonState(isLoading) {
                const btn = document.getElementById('sendBtn');
                const text = document.getElementById('btnText');
                const spinner = document.getElementById('btnSpinner');
                
                if (isLoading) {
                    btn.disabled = true;
                    text.textContent = 'åˆ†æä¸­...';
                    spinner.style.display = 'inline-block';
                } else {
                    btn.disabled = false;
                    text.textContent = 'ğŸ” åˆ†æé–‹å§‹';
                    spinner.style.display = 'none';
                }
            }
            
            updateSecurityStatus(status) {
                const element = document.getElementById('securityStatus');
                element.textContent = 
                    status === 'active' ? 'ã‚»ã‚­ãƒ¥ã‚¢' :
                    status === 'warning' ? 'è­¦å‘Š' :
                    status === 'error' ? 'å±é™º' : 'æœªç¢ºèª';
                
                element.className = `status-badge status-${status}`;
            }
            
            updateStats() {
                document.getElementById('totalRequests').textContent = this.totalRequests;
                document.getElementById('totalServers').textContent = this.detectedServers.size;
            }
            
            startUptimeCounter() {
                setInterval(() => {
                    const uptime = Math.floor((Date.now() - this.startTime) / 1000);
                    document.getElementById('uptime').textContent = `${uptime}s`;
                }, 1000);
            }
            
            clearAnalysis() {
                if (confirm('ã™ã¹ã¦ã®åˆ†æçµæœã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                    this.logs = [];
                    document.getElementById('logContainer').innerHTML = `
                        <div class="log-entry info">
                            <div class="log-time">${new Date().toLocaleTimeString()}</div>
                            <div class="log-message">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</div>
                        </div>
                    `;
                    
                    this.updatePathDiagram([]);
                    this.updateDatabaseList([]);
                    
                    // çµ±è¨ˆæƒ…å ±ã®ãƒªã‚»ãƒƒãƒˆ
                    document.getElementById('firewallCount').textContent = '0ä»¶';
                    document.getElementById('blockCount').textContent = '0ç®‡æ‰€';
                    document.getElementById('cdnCount').textContent = '0ä»¶';
                    document.getElementById('responseTime').textContent = '-';
                    document.getElementById('httpStatus').textContent = '-';
                    document.getElementById('hopCount').textContent = '0';
                    document.getElementById('dbStatus').textContent = 'æœªæ¤œå‡º';
                    document.getElementById('dbStatus').className = "status-badge";
                    document.getElementById('pathStatus').textContent = 'æº–å‚™å®Œäº†';
                    document.getElementById('sslStatus').textContent = 'æœªç¢ºèª';
                    document.getElementById('sslStatus').style.color = "";
                    
                    this.addLog("åˆ†æçµæœã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ", "info");
                }
            }
            
            exportLogs() {
                const logData = this.logs.map(log => 
                    `[${log.time}] ${log.type.toUpperCase()}: ${log.message}`
                ).join('\n');
                
                const blob = new Blob([logData], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `request-analysis-logs-${new Date().toISOString().slice(0,10)}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.addLog("ãƒ­ã‚°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ", "success");
            }
            
            detectBrowser() {
                const ua = navigator.userAgent;
                if (ua.includes('Chrome')) return 'Chrome';
                if (ua.includes('Firefox')) return 'Firefox';
                if (ua.includes('Safari')) return 'Safari';
                if (ua.includes('Edge')) return 'Edge';
                return 'Unknown';
            }
            
            generatePseudoIP() {
                // ç–‘ä¼¼IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç”Ÿæˆï¼ˆå®Ÿéš›ã®IPã¯å–å¾—ä¸å¯ï¼‰
                const segments = [
                    Math.floor(Math.random() * 255),
                    Math.floor(Math.random() * 255),
                    Math.floor(Math.random() * 255),
                    Math.floor(Math.random() * 255)
                ];
                return segments.join('.');
            }
        }
        
        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•
        document.addEventListener('DOMContentLoaded', () => {
            window.analyzer = new RequestAnalyzer();
            
            // ãƒ‡ãƒ¢ç”¨ã®åˆæœŸãƒ­ã‚°
            setTimeout(() => {
                window.analyzer.addLog("ãƒ„ãƒ¼ãƒ«ã®æº–å‚™ãŒå®Œäº†ã—ã¾ã—ãŸ", "success");
                window.analyzer.addLog("URLã‚’å…¥åŠ›ã—ã¦ã€Œåˆ†æé–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„", "info");
            }, 1000);
        });
    </script>
</body>
</html>
